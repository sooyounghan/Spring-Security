-----
### 시큐리티 인증 / 인가 흐름도
-----
<div align="center">
<img src="https://github.com/user-attachments/assets/3be1859e-024b-4ac8-bfe7-d819b5411396">
</div>

-----
### AuthenticationProvider
-----
1. 사용자의 자극 증명을 확인하고, 인증 과정을 관리하는 클래스로서 사용자가 시스템에 액세스하기 위해 제공한 정보 (예) 아이디와 비밀번호)가 유효한지 검증하는 과정 포함
2. 다양한 유형의 인증 메커니즘을 지원할 수 있는데, 예를 들어 표준 사용자의 이름과 비밀번호를 기반으로 한 인증, 토큰 기반 인증, 지문 인식 등을 처리 가능
3. 성공적인 인증 후에는 Authentication 객체를 반환하며 이 객체에는 사용자의 신원 정보와 인증된 자격 증명을 포함
4. 인증 과정 중에는 문제가 발생한 경우 AuthenticationException과 같은 예외를 발생시켜 문제를 알리는 역할을 함
<div align="center">
<img src="https://github.com/user-attachments/assets/f5b6d68f-174d-40a3-bbfc-53327eb98e6e">
</div>

  - authenticate(Authentication) : AuthenticationManager로부터 Authentication 객체를 전달 받아 인증 수행
  - supports(Class```<?>```) : 인증을 수행할 수 있는 조건인지 검사

-----
### AuthenticationProvider 흐름도
-----
<div align="center">
<img src="https://github.com/user-attachments/assets/c6599e30-2f2a-4b64-b318-a1527b4b9377">
</div>

-----
### AuthenticationProvider 사용 방법 - 일반 객체로 생성 (Bean 객체가 아님)
-----
```java
@Bean
public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
    // 모두 동일한 처리 (AuthenticationManagerBuilder 접근) 
    AuthenticationManagerBuilder managerBuilder = http.getSharedObject(AuthenticationManagerBuilder.class);
    managerBuilder.authenticationProvider(new CustomAuthenticationProvider());
    // 모두 동일한 처리 (Http 접근)
    http.authenticationProvider(new CustomAuthenticationProvider2());

    http.authorizeHttpRequests(auth -> auth.anyRequest().authenticated());
    http.formLogin(Customizer.withDefaults());

    return http.build();
}
```
<div align="center">
<img src="https://github.com/user-attachments/assets/9ec9ec56-5606-45b0-a52c-6bd3d4ad1a4f">
</div>

-----
### 💡 AuthenticationProvider 사용 방법 - Bean으로 생성
-----
1. Bean을 한 개만 정의할 경우
  - AuthenticationProvider를 빈으로 정의하면 DaoAuthenticationProvider를 자동으로 대체
```java
@Bean
public AuthenticationProvider customAuthenticationProvider() {
    return new CustomAuthenticationProvider();
}
```
<div align="center">
<img src="https://github.com/user-attachments/assets/eb24e671-1ffb-480f-b9aa-9ac983f10078">
</div>

```java
@Bean
public SecurityFilterChain securityFilterChain(HttpSecurity http, AuthenticationManagerBuilder builder, AuthenticationConfiguration configuration) throws Exception {
    AuthenticationManagerBuilder managerBuilder = http.getSharedObject(AuthenticationManagerBuilder.class); // authenticationManager (ProviderManager)
    managerBuilder.authenticationProvider(customAuthenticationProvider()); // AuthenticationManagerVuilder를 통해 customAuthenticationProvider 추가
    ProviderManager providerManager = (ProviderManager) configuration.getAuthenticationManager(); // AuthenticationConfiguration을 통해 AuthencticationManager를 읽어옴
    providerManager.getProviders().remove(0); // Manager로부터 첫 번째 목록 삭제 (= 즉, CustomAuthenticationProvider 제거하는데, 이는 parent도 참조하므로 같이 삭제)
    builder.authenticationProvider(new DaoAuthenticationProvider()); // DaoAuthenticationProviderfmf ProviderManager에 추가(parent)

    http.authorizeHttpRequests(auth -> auth.anyRequest().authenticated());
    return http.build();
}
```
<div align="center">
<img src="https://github.com/user-attachments/assets/efc16f5d-5f25-4e84-b054-4f0816a91d83">
</div>

2. 빈을 두 개 이상 정의할 경우
```java
@Bean
public SecurityFilterChain securityFilterChain(HttpSecurity http) thorws Exception {
    AuthenticationManagerBuilder managerBuilder = http.getSharedObject(AuthenticationManagerBuilder.class);
    managerBuilder.authenticationProvider(customAuthenticationProvider());
    managerBuilder.authenticationProvider(customAuthenticationProvider2());

    http.authroizeHttpReqeusts(auth -> auth.anyRequest().authenticated());
    http.formLogin(Customizer.withDefaults());

    return http.build();
}

@Bean
public AuthenticationProvider customAuthenticationProvider() {
    return new CustomAuthenticationProvier();
}

@Bean
public AuthenticationProvider customAuthenticationProvider2() {
    return new CustomAuthenticationProvier();
}
```
<div align="center">
<img src="https://github.com/user-attachments/assets/131c6dc1-ec03-4ea6-a672-2c0bf22ac90d">
</div>


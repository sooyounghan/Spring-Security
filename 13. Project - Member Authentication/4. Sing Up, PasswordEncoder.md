-----
### PasswordEncoder
-----
1. ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì˜ PasswordEncoder ì¸í„°í˜ì´ìŠ¤ëŠ” ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•ˆì „í•˜ê²Œ ì €ì¥í•˜ê¸° ìœ„í•´ ë¹„ë°€ë²ˆí˜¸ì˜ ë‹¨ë°©í–¥ ë³€í™˜ì„ ìˆ˜í–‰í•˜ëŠ”ë° ì‚¬ìš©
2. ğŸ’¡ ì¼ë°˜ì ìœ¼ë¡œ PassswordEncoderëŠ” ì‚¬ìš©ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•”í˜¸í™”í•˜ì—¬ ì €ì¥í•˜ê±°ë‚˜ ì¸ì¦ ì‹œ ê²€ì¦ì„ ìœ„í•´ ì…ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ì™€ ì•”í˜¸í™”ë˜ì–´ ì €ì¥ëœ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì„œë¡œ ë¹„êµí•  ë•Œ ì‚¬ìš©
<div align="center">
<img src="https://github.com/user-attachments/assets/aab32d46-f9f9-4667-b5f8-7a997c6575fd">
</div>

-----
### DelegatingPasswordEncoder
-----
1. ```{id}``` í˜•ì‹ì˜ ì ‘ë‘ì‚¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„ë°€ë²ˆí˜¸ê°€ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ ì¸ì½”ë”©ë˜ì—ˆëŠ”ì§€ ì‹ë³„í•˜ëŠ” í´ë˜ìŠ¤
2. ì˜ˆë¥¼ ë“¤ì–´, ```{bcrypt}``` ì ‘ë‘ì‚¬ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ BCrypt ë°©ì‹ìœ¼ë¡œ ì¸ì½”ë”© ë˜ì—ˆìŒì„ ë‚˜íƒ€ëƒ„ (ê¸°ë³¸ì€ BCrypt ë°©ì‹)
<div align="center">
<img src="https://github.com/user-attachments/assets/8263d64f-0d9b-4d52-9407-72d0abcdaef8">
</div>

3. ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê¸°ë³¸ ì¸ì½”ë”© ë°©ì‹ì„ ë³€ê²½í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ë©°, ìƒˆë¡œìš´ ì¸ì½”ë”© ë°©ì‹ì´ ê¶Œì¥ë˜ê±°ë‚˜ í•„ìš”í•  ë•Œ ë¹„ë°€ë²ˆí˜¸ ì¸ì½”ë”© ì „ëµì„ ìœ ì—°í•˜ê²Œ ìœ ì§€ ê°€ëŠ¥

-----
### DelegatingPasswordEncoder ë¹ˆ ì •ì˜
-----
1. ê¸°ë³¸ ìƒì„±
```java
@Bean
public PasswordEncoder passwordEncoder() {
    return PasswordEncoderFactories.createDelegatingPasswordEncoder(); // ê¸°ë³¸ì ìœ¼ë¡œ bcrypt ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ì˜ BCryptPasswordEncoder ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì‚¬ìš©
}
```

2. ì•Œê³ ë¦¬ì¦˜ ì§€ì • ìƒì„±
```java
@Bean
public PasswordEncoder passwordEncoder() {
    String encodingId = "pbkdf2";

    Map<String, PasswordEncoder> encoders = new HashMap<>();

    encoders.put(encodingId, Pbkdf2PasswordEncoder.defaultsForSpringSecurity_v5_8());

    DelegatingPasswordEncoder delegatingPasswordEncoder = new DelegatingPasswordEncoder(encodingId, encoders);

    return delegatingPasswordEncoder;
}
```

-----
### ì‹œíë¦¬í‹° ì§€ì› ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ ìœ í˜•
-----
```java
String encodingId = "bcrypt"; // ê¸°ë³¸ì€ BCrypt
Map<String, PasswordEncoder> encoders = new HashMap<>();
encoders.put(encodingId, new BCryptPasswordEncoder());
encoders.put("ldap", new org.springframework.security.crypto.password.LdapShaPasswordEncoder());
encoders.put("MD4", new org.springframework.security.crypto.password.Md4PasswordEncoder());
encoders.put("MD5", new org.springframework.security.crypto.password.MessageDigestPasswordEncoder("MD5"));
encoders.put("noop", org.springframework.security.crypto.password.NoOpPasswordEncoder.getInstance());
encoders.put("pbkdf2", Pbkdf2PasswordEncoder.defaultsForSpringSecurity_v5_5());
encoders.put("pbkdf2@SpringSecurity_v5_8", Pbkdf2PasswordEncoder.defaultsForSpringSecurity_v5_8());
encoders.put("scrypt", SCryptPasswordEncoder.defaultsForSpringSecurity_v4_1());
encoders.put("scrypt@SpringSecurity_v5_8", SCryptPasswordEncoder.defaultsForSpringSecurity_v5_8());
encoders.put("SHA-1", new org.springframework.security.crypto.password.MessageDigestPasswordEncoder("SHA-1"));
encoders.put("SHA-256", new org.springframework.security.crypto.password.MessageDigestPasswordEncoder("SHA-256"));
encoders.put("sha256", new org.springframework.security.crypto.password.StandardPasswordEncoder());
encoders.put("argon2", Argon2PasswordEncoder.defaultsForSpringSecurity_v5_2());
encoders.put("argon2@SpringSecurity_v5_8", Argon2PasswordEncoder.defaultsForSpringSecurity_v5_8());
```

-----
### ì‚¬ìš©ì ìƒì„±ê³¼ ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”
-----
<div align="center">
<img src="https://github.com/user-attachments/assets/3b1a06d8-0c23-4417-8afc-5f3cccc7adbb">
</div>

-----
### ì½”ë“œ
-----
1. ì˜ì¡´ì„± ì¶”ê°€ (JPA, ModelMapper ì¶”ê°€)
```java
implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
implementation 'org.modelmapper:modelmapper:3.2.1'
```

  - ModelMapper : ì„œë¡œ ë‹¤ë¥¸ í´ë˜ìŠ¤ì˜ ê°’ì„ í•œ ë²ˆì— ë³µì‚¬í•˜ê²Œ ë„ì™€ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬

2. application.properties í™˜ê²½ì„¤ì •
```properties
spring.application.name=springSecurityMaster

spring.datasource.url=jdbc:postgresql://localhost:5432/springboot
spring.datasource.username=postgres
spring.datasource.password=pass

spring.jpa.hibernate.ddl-auto=create
spring.jpa.properties.hibernate.format_sql=true

# ì‹¤í–‰ ì‹œ Warnning ì œê±°
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# íƒ€ì„ë¦¬í”„ í…œí”Œë« ìºì‹± ì„¤ì • OFF
spring.thymeleaf.cache=false
```

3. Postgres SQL ì„¤ì¹˜ (Docker)
   - ```docker run -d -p 5432:5432 -e POSTGRES_PASSWORD=pass --name postgres postgres```
   - ì»¨í…Œì´ë„ˆ postgresql ì ‘ì† :  ```docker exec -it [CONTAINER ID] bin/bash```
   - PostgreSQL ì ‘ì† : ```psql -U postgres```
   - ë°ì´í„°ë² ì´ìŠ¤ ìƒì„± :  ```create database ë°ì´í„°ë² ì´ìŠ¤ëª…;```
   - ì¡°íšŒ : ```\l```

4. singup.html
```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Dashboard</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #1e1e2f; /* ì–´ë‘ìš´ ë°°ê²½ìƒ‰ */
            color: #abb2bf; /* ë¶€ë“œëŸ¬ìš´ ê¸€ììƒ‰ */
        }
        .navbar-custom {
            background-color: #212338; /* ì–´ë‘ìš´ ë„¤ì´ë¹„ */
            color: #fff;
            margin-bottom: 0;
        }
        .container-fluid {
            padding: 0; /* containerì˜ íŒ¨ë”© ì œê±° */
        }
        .navbar-custom .navbar-brand, .navbar-custom .nav-link {
            color: #fff;
        }
        .sidebar {
            background-color: #212338; /* ì–´ë‘ìš´ ë„¤ì´ë¹„ */
            min-height: 100vh;
            color: #fff;
        }
        .sidebar a {
            color: #fff;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .sidebar a:hover {
            background-color: #4e73df; /* ë°ì€ í‘¸ë¥¸ìƒ‰ */
            color: #fff;
        }
        .content {
            padding: 20px;
            background-color: #282a36; /* ì–´ë‘ìš´ ê·¸ë ˆì´ */
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            margin-top: 0;
        }
        .footer {
            background-color: #212338; /* ì–´ë‘ìš´ ë„¤ì´ë¹„ */
            color: #fff;
            padding: 10px 0;
            border-top: 1px solid #282a36;
        }
        .sidebar .list-group-item {
            color: white; /* ê¸°ë³¸ ê¸€ììƒ‰ */
            background-color: transparent; /* ê¸°ë³¸ ë°°ê²½ìƒ‰ */
            transition: background-color 0.3s ease, color 0.3s ease; /* ë¶€ë“œëŸ¬ìš´ ìƒ‰ìƒ ì „í™˜ íš¨ê³¼ */
        }

        .sidebar .list-group-item:hover {
            background-color: #4e73df; /* ë§ˆìš°ìŠ¤ ì˜¤ë²„ì‹œ ë°°ê²½ìƒ‰ */
            color: #fff; /* ë§ˆìš°ìŠ¤ ì˜¤ë²„ì‹œ ê¸€ììƒ‰ */
        }
        /* ì¤‘ì•™ ë¡œê·¸ì¸ í¼ ìŠ¤íƒ€ì¼ */
        .signup-form {
            max-width: 400px;
            margin: 30px auto;
            padding: 20px;
            background-color: #2e2e2e; /* ì–´ë‘ìš´ í¼ ë°°ê²½ìƒ‰ */
            border-radius: 5px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
        }
        .signup-form h2 {
            color: #fff; /* ë°ì€ ê¸€ììƒ‰ */
            margin-bottom: 20px;
        }
        .signup-form .form-control {
            background-color: #3a3b45; /* ì–´ë‘ìš´ ì…ë ¥ í•„ë“œ ë°°ê²½ìƒ‰ */
            color: #fff; /* ë°ì€ ì…ë ¥ í•„ë“œ ê¸€ììƒ‰ */
            border: none;
        }
        .signup-form .btn-primary {
            background-color: #4e73df; /* ë°ì€ ë²„íŠ¼ ìƒ‰ìƒ */
            border: none;
        }
    </style>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</head>
<body>
<div th:replace="~{layout/header::header}"></div>
<div class="container-fluid">
    <div class="row">
        <div class="col-md-2 sidebar">
            <div th:replace="~{layout/sidebar::sidebar}"></div>
        </div>
        <div class="col-md-10 content">
            <div class="signup-form">
                <h2>Sign Up</h2>
                <form th:action="@{/signup}" method="post">
                    <div class="form-group">
                        <label for="username">Username</label>
                        <input type="text" class="form-control" id="username" name="username" required>
                    </div>
                    <div class="form-group">
                        <label for="password">Password</label>
                        <input type="password" class="form-control" id="password" name="password" required>
                    </div>
                    <div class="form-group">
                        <label for="age">Age</label>
                        <input type="number" class="form-control" id="age" name="age" required>
                    </div>
                    <div class="form-group">
                        <label for="roles">Authority</label>
                        <select class="form-control" id="roles" name="roles">
                            <option>ROLE_USER</option>
                            <!-- <option>ROLE_MANAGER</option>
                             <option>ROLE_ADMIN</option>-->
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">Sign Up</button>
                </form>
            </div>
        </div>
    </div>
</div>
<div class="footer" th:replace="~{layout/footer::footer}"></div>
</body>
</html>
```

5. SecurityConfig
```java
package io.security.springSecurityMaster.configs;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.core.userdetails.User;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.crypto.factory.PasswordEncoderFactories;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.provisioning.InMemoryUserDetailsManager;
import org.springframework.security.web.SecurityFilterChain;

@EnableWebSecurity
@Configuration
public class SecurityConfig {

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http.
                authorizeHttpRequests(auth -> auth
                        .requestMatchers("/css/**", "/images/**", "/js/**", "/favicon.*", "/*/icon-*").permitAll()
                        .requestMatchers("/", "/signup").permitAll()
                        .anyRequest().authenticated())
                .formLogin(form -> form.loginPage("/login").permitAll());

        return http.build();
    }

    @Bean
    public PasswordEncoder passwordEncoder() {
        return PasswordEncoderFactories.createDelegatingPasswordEncoder();
    }

    @Bean
    public UserDetailsService userDetailsService() throws Exception {
        UserDetails user = User.withUsername("user").password("{noop}1111").roles("USER").build();

        return new InMemoryUserDetailsManager(user);
    }
}
```

6. LoginController
```java
package io.security.springSecurityMaster.users.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;

@Controller
public class LoginController {

    @GetMapping("/login")
    public String login() {
        return "login/login";
    }
    
    @GetMapping("/singup")
    public String signup() {
        return "login/signup";
    }
}
```

7. AccountDto
```java
package io.security.springSecurityMaster.domain;

import lombok.Builder;
import lombok.Data;

@Data
@Builder
public class AccountDto {
    private String id;
    private String username;
    private String password;
    private int age;
    private String roles;
}
```

8. Account
```java
package io.security.springSecurityMaster.domain.entity;

import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.Id;
import lombok.Data;

@Data
@Entity
public class Account {

    @Id
    @GeneratedValue
    private String id;

    private String username;
    private String password;
    private int age;
    private String roles;
}
```

9. UserController
```java
package io.security.springSecurityMaster.users.controller;

import io.security.springSecurityMaster.domain.dto.AccountDto;
import io.security.springSecurityMaster.domain.entity.Account;
import io.security.springSecurityMaster.users.service.UserService;
import lombok.RequiredArgsConstructor;
import org.modelmapper.ModelMapper;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PostMapping;

@Controller
@RequiredArgsConstructor
public class UserController {

    private final PasswordEncoder passwordEncoder;
    private final UserService userService;

    @PostMapping("/signup")
    public String signup(AccountDto accountDto) {
        ModelMapper mapper = new ModelMapper(); // Accountì™€ AccountDtoë¥¼ Mapping

        Account account = mapper.map(accountDto, Account.class); // accountDtoëŠ” ì›ë³¸, ì›ë³¸ì„ ë³µì‚¬í•˜ì—¬ ë°›ì„ Account í´ë˜ìŠ¤ì— ë³µì‚¬

        account.setPassword(passwordEncoder.encode(accountDto.getPassword())); // ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¸ì½”ë”© ì•”í˜¸í™”í•˜ì—¬ account ê°ì²´ì— ì €ì¥

        userService.createUser(account);
        
        return "redirect:/";
    }
}
```

10. UserRepository
```java
package io.security.springSecurityMaster.users.repository;

import io.security.springSecurityMaster.domain.entity.Account;
import org.springframework.data.jpa.repository.JpaRepository;

public interface UserRepository extends JpaRepository<Account, Long> {

}
```

11. UserService
```java
package io.security.springSecurityMaster.users.service;

import io.security.springSecurityMaster.domain.entity.Account;
import io.security.springSecurityMaster.users.repository.UserRepository;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

@Service
@RequiredArgsConstructor
public class UserService {

    private final UserRepository userRepository;

    @Transactional
    public void createUser(Account account) {
        userRepository.save(account);
    }
}
```

12. header.html ìˆ˜ì •
```html
<li class="nav-item">
    <a class="nav-link" href="/signup">íšŒì›ê°€ì…</a>
</li>
```

